<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fineguide Demo Preview</title>
    <style>
        html, body {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
        }
        
        .iframe-container {
            width: 100%;
            height: 100%;
            position: relative;
        }
        
        iframe {
            width: 100%;
            height: 100%;
            border: none;
            position: absolute;
            top: 0;
            left: 0;
            z-index: 1;
        }
        
        .error-container {
            display: none;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, #f8fafc, #f1f5f9);
            z-index: 2;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            text-align: center;
            box-sizing: border-box;
        }
        
        .error-icon {
            width: 80px;
            height: 80px;
            margin-bottom: 1.5rem;
            background: linear-gradient(to right, #2b1869, #5E35B1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 10px 25px rgba(94, 53, 177, 0.3);
        }
        
        .error-icon svg {
            width: 40px;
            height: 40px;
            color: white;
        }
        
        .error-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 0.75rem;
        }
        
        .error-message {
            font-size: 1rem;
            color: #64748b;
            max-width: 500px;
            margin-bottom: 1.5rem;
            line-height: 1.5;
        }
        
        .agent-hint {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 2rem;
            position: relative;
        }
        
        .agent-hint-text {
            font-size: 0.95rem;
            color: #5E35B1;
            font-weight: 600;
            background: rgba(94, 53, 177, 0.1);
            padding: 0.75rem 1.25rem;
            border-radius: 0.5rem;
            max-width: 400px;
            text-align: center;
            line-height: 1.4;
        }
        
        .arrow-container {
            position: absolute;
            bottom: -60px;
            right: 30px;
            transform: rotate(-30deg);
            display: none;
        }
        
        @media (min-width: 768px) {
            .arrow-container {
                display: block;
            }
        }
        
        .curved-arrow {
            width: 80px;
            height: 80px;
            border: 2px solid #ff5722;
            border-color: #ff5722 transparent transparent #ff5722;
            border-radius: 100px 0 0 0;
            position: relative;
        }
        
        .curved-arrow:after {
            content: '';
            position: absolute;
            width: 12px;
            height: 12px;
            border-top: 2px solid #ff5722;
            border-right: 2px solid #ff5722;
            transform: rotate(45deg);
            right: -6px;
            top: 10px;
        }
        
        .try-another-btn {
            background: linear-gradient(to right, #2b1869, #5E35B1);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 0.375rem;
            font-weight: 600;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
        }
        
        .try-another-btn:hover {
            opacity: 0.9;
            transform: translateY(-1px);
        }
        
        .company-name {
            color: #5E35B1;
            font-weight: 600;
        }
        
        .loading-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, #f8fafc, #f1f5f9);
            z-index: 3;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            text-align: center;
            box-sizing: border-box;
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(94, 53, 177, 0.1);
            border-left-color: #5E35B1;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 1.5rem;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="iframe-container">
        <div class="loading-container" id="loadingContainer">
            <div class="loading-spinner"></div>
            <div class="error-title">Loading website...</div>
            <p class="error-message">Please wait while we load the website with Fineguide AI agent integration.</p>
        </div>
        
        <div class="error-container" id="errorContainer">
            <div class="error-icon">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                </svg>
            </div>
            <h2 class="error-title">Website could not be displayed</h2>
            <p class="error-message">
                <span id="websiteDomain" class="company-name"></span> couldn't be loaded due to security restrictions or content protection. 
                This is common with many websites that have protection against being displayed in iframes.
                The Fineguide AI agent would still work properly when properly integrated with your website.
            </p>
            
            <div class="agent-hint">
                <div class="agent-hint-text">
                    You can still interact with the Fineguide AI agent! It can answer questions about <b id="websiteDomain2" class="company-name"></b>. <br> Feel free to test it out!
                </div>
            </div>
        </div>
        
        <iframe src="" frameborder="0" id="iframe"></iframe>
    </div>

    <!-- Insert this code in the header section of your website, or right above the closing </body> tag -->
    <script>
        const params = new URLSearchParams(window.location.search);
        // transform params to object
        const paramsObject = Object.fromEntries(params.entries());

        var FINEGUIDE_CHATBOT_ID = 'ccf37b6c-d90d-4a23-8670-5934f846bb31';
        var FINEGUIDE_PARAMS = paramsObject;
        const iframe = document.getElementById('iframe');
        const errorContainer = document.getElementById('errorContainer');
        const loadingContainer = document.getElementById('loadingContainer');
        const websiteDomain = document.getElementById('websiteDomain');
        const websiteDomain2 = document.getElementById('websiteDomain2');
        const url = params.get('search_domains');
        
        // Set the website domain in the error message
        websiteDomain.textContent = url || 'The website';
        websiteDomain2.textContent = url || 'the website';
        
        // Set iframe source
        iframe.src = `https://${url}`;
        
        // Handle iframe load errors
        iframe.addEventListener('load', function() {
            // Hide loading container when iframe is loaded
            loadingContainer.style.display = 'none';
            
            try {
                // Try to access iframe content - if this fails, it means the website has X-Frame-Options restrictions
                const iframeContent = iframe.contentWindow.document;
                // If we can access the content, the iframe loaded successfully
            } catch (e) {
                // If we can't access the content, show the error container
                errorContainer.style.display = 'flex';
                iframe.style.display = 'none';
            }
        });
        
        // Set a timeout to show error if the iframe takes too long to load
        setTimeout(function() {
            if (loadingContainer.style.display !== 'none') {
                loadingContainer.style.display = 'none';
                errorContainer.style.display = 'flex';
                iframe.style.display = 'none';
            }
        }, 10000); // 10 seconds timeout
    </script>
    <script src="https://cdn.fineguide.ai/fineguide.min.js"></script>
</body>
</html>